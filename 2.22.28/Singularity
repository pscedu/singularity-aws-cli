Bootstrap: docker
From: debian:latest

%labels
    AUTHOR icaoberg
    EMAIL icaoberg@psc.edu
    SUPPORT help@psc.edu
    REPOSITORY http://gitub.com/pscedu/singularity-aws-cli
    COPYRIGHT Copyright Â© 2021-2025 Pittsburgh Supercomputing Center. All Rights Reserved.   
    VERSION 2.22.28

%post
   apt update
   apt install -y curl unzip groff
   curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
   unzip awscliv2.zip
   cd aws
   ./install -i /opt/aws-cli -b /usr/bin
   cd ..
   rm -f awscliv2.zip
   rm -rfv aws

%runscript
   /usr/bin/aws "$@"   

%test
   echo "Testing AWS CLI installation and version..."
   if ! command -v aws > /dev/null; then
      echo "AWS CLI is not installed or not found in PATH"
      exit 1
   fi
